<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pesquisa Impulso DISC</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #a5f3fc, #06b6d4);
      font-family: 'Inter', sans-serif;
    }
    .scale-option {
      transition: all 0.2s ease;
      border: 2px solid #cbd5e1;
      border-radius: 8px;
      padding: 8px;
      text-align: center;
      cursor: pointer;
      background-color: #f8fafc;
      font-weight: 600;
    }
    .scale-option:hover {
      background-color: #e0f2fe;
      border-color: #38bdf8;
    }
    .scale-option:active {
      transform: scale(1.1);
    }
    .scale-option.selected {
      background: linear-gradient(135deg, #3b82f6, #1e40af);
      color: white;
      border-color: #1e40af;
    }
    .bar-3d {
      position: relative;
      height: 30px;
      width: 80px;
      border-radius: 0 8px 8px 0;
      box-shadow: 
        8px 0 15px rgba(0,0,0,0.15),
        inset -3px 0 8px rgba(0,0,0,0.1);
      transition: width 1.2s cubic-bezier(0.2, 0.8, 0.4, 1);
    }
    .bar-value {
      position: absolute;
      right: -30px;
      top: 50%;
      transform: translateY(-50%);
      color: white;
      font-weight: 700;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
      font-size: 0.9em;
      background: rgba(0,0,0,0.65);
      padding: 2px 8px;
      border-radius: 15px;
    }
    .btn-primary {
      background: linear-gradient(135deg, #3b82f6, #1e40af);
      transition: transform 0.1s ease;
    }
    .btn-primary:active {
      transform: scale(1.1);
    }
    .btn-secondary {
      background: linear-gradient(135deg, #6b7280, #4b5563);
    }
    .btn-result {
      background: linear-gradient(135deg, #ec4899, #be185d);
      transition: transform 0.1s ease;
    }
    .btn-result:active {
      transform: scale(1.1);
    }
    .btn-start {
      background: linear-gradient(135deg, #22d3ee, #0ea5e9);
    }
    .signature {
      font-family: 'Dancing Script', cursive;
      color: #0ea5e9;
      font-size: 1.4rem;
    }
    .alert-blink {
      animation: blink 1.2s infinite;
      background: linear-gradient(135deg, #dbeafe, #bfdbfe);
      border-left: 4px solid #3b82f6;
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
      font-weight: 600;
      color: #1e40af;
    }
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }
    .input-icon {
      position: relative;
    }
    .input-icon svg {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      width: 20px;
      height: 20px;
      color: #4b5563;
    }
    .input-icon input {
      padding-left: 40px;
    }
    .progress-bar {
      height: 8px;
      background: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 12px;
    }
    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #0ea5e9);
      transition: width 0.3s ease;
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
  <div class="max-w-3xl w-full bg-white rounded-2xl shadow-xl p-6 md:p-8">
    <h2 class="text-3xl md:text-4xl font-bold text-center text-transparent bg-clip-text bg-gradient-to-r from-teal-500 to-blue-600 mb-2">Impulso Coaching</h2>
    <h1 class="text-4xl md:text-5xl font-extrabold text-center text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-teal-500 mb-4">Pesquisa Impulso DISC</h1>
    <p class="text-center text-gray-600 mb-6">A Mudan√ßa Pode Acontecer Em Um Instante</p>

    <!-- Formul√°rio Inicial -->
    <div id="intro">
      <div class="bg-gradient-to-r from-blue-100 to-teal-100 p-5 rounded-lg mb-4 shadow-md">
        <p class="text-lg font-semibold text-gray-800 mb-3">Dados Pessoais</p>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3">
          <div class="input-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
            <input type="text" id="name" placeholder="Nome *" class="border border-teal-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-teal-500 bg-gradient-to-r from-white to-teal-50">
          </div>
          <div class="input-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
            <input type="number" id="age" placeholder="Idade *" class="border border-teal-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-teal-500 bg-gradient-to-r from-white to-teal-50">
          </div>
          <div class="input-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
            <input type="text" id="occupation" placeholder="Profiss√£o" class="border border-teal-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-teal-500 bg-gradient-to-r from-white to-teal-50">
          </div>
        </div>
        <div class="input-icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
          <input type="email" id="email" placeholder="Email *" class="border border-teal-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-teal-500 bg-gradient-to-r from-white to-teal-50">
        </div>
        <div class="flex justify-end mt-3">
          <button onclick="startTest()" class="btn-start text-white px-5 py-2 rounded-lg transition shadow-md text-sm md:text-base">Iniciar Pesquisa</button>
        </div>
      </div>

      <div class="alert-blink text-center text-sm md:text-base">
        <p class="font-bold">Dicas para Responder</p>
        <ul class="list-disc list-inside mt-1 space-y-1">
          <li>Seja honesto: responda como voc√™ realmente √©.</li>
          <li>Pense em situa√ß√µes do seu cotidiano.</li>
          <li>Escolha a afirma√ß√£o que melhor te descreve.</li>
          <li>N√£o h√° respostas certas ou erradas!</li>
        </ul>
      </div>
    </div>

    <!-- Teste -->
    <div id="test-section" class="hidden">
      <div id="current-question"></div>
    </div>

    <!-- Resultado -->
    <div id="result" class="hidden mt-4">
      <div class="bg-gradient-to-r from-blue-50 to-teal-50 p-4 rounded-lg shadow-md mb-4">
        <h2 class="text-2xl font-extrabold text-center text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-teal-500 mb-2">Pesquisa Impulso DISC</h2>
        <p class="text-center text-gray-700 text-sm mb-2" id="personal-data"></p>
        <p class="text-center text-gray-700 text-sm">Explore como suas caracter√≠sticas se distribuem nas quatro dimens√µes do DISC e descubra seus pontos fortes e √°reas de melhoria.</p>
      </div>

      <!-- Barras Horizontais -->
      <div id="scores" class="flex flex-col space-y-4 mb-6 bg-gray-50 rounded-lg p-4">
        <div class="flex items-center">
          <div class="font-bold text-red-600 text-sm mr-4 w-24">Domin√¢ncia<br><span class="text-xs">Fogo / Col√©rico</span></div>
          <div class="bar-3d score-d" id="bar-dominancia" style="width: 0px"><div class="bar-value" id="val-dominancia">0%</div></div>
        </div>
        <div class="flex items-center">
          <div class="font-bold text-orange-600 text-sm mr-4 w-24">Influ√™ncia<br><span class="text-xs">Ar / Sangu√≠neo</span></div>
          <div class="bar-3d score-i" id="bar-influencia" style="width: 0px"><div class="bar-value" id="val-influencia">0%</div></div>
        </div>
        <div class="flex items-center">
          <div class="font-bold text-blue-600 text-sm mr-4 w-24">Estabilidade<br><span class="text-xs">√Ågua / Fleum√°tico</span></div>
          <div class="bar-3d score-s" id="bar-estabilidade" style="width: 0px"><div class="bar-value" id="val-estabilidade">0%</div></div>
        </div>
        <div class="flex items-center">
          <div class="font-bold text-green-600 text-sm mr-4 w-24">Conformidade<br><span class="text-xs">Terra / Melanc√≥lico</span></div>
          <div class="bar-3d score-c" id="bar-conformidade" style="width: 0px"><div class="bar-value" id="val-conformidade">0%</div></div>
        </div>
      </div>

      <div id="dominant-section" class="mt-4 space-y-3"></div>

      <div id="disc-explanation" class="bg-gradient-to-r from-blue-100 to-teal-100 p-4 rounded-lg mt-4 shadow-md">
        <p class="text-lg font-semibold text-gray-800 mb-2">O que √© o DISC?</p>
        <p class="text-gray-700 text-xs">
          O DISC¬Æ √© uma metodologia de avalia√ß√£o comportamental desenvolvida com base nos estudos de William Marston, utilizada h√° mais de 38 anos por mais de 53 milh√µes de pessoas em todo o mundo. A ferramenta categoriza comportamentos em quatro dimens√µes principais: Domin√¢ncia (D), Influ√™ncia (I), Estabilidade (S) e Conformidade (C). Cada dimens√£o reflete um conjunto de caracter√≠sticas que ajudam a compreender como as pessoas abordam desafios, interagem com os outros, lidam com mudan√ßas e seguem regras ou processos.
        </p>
        <p class="text-gray-700 text-xs mt-2">
          O DISC √© amplamente utilizado em contextos corporativos e pessoais para promover autoconhecimento, melhorar a comunica√ß√£o e construir equipes mais eficazes. Seus benef√≠cios incluem:
        </p>
        <ul class="list-disc list-inside text-gray-700 mt-1 text-xs">
          <li>Desenvolvimento de lideran√ßa e resolu√ß√£o de conflitos.</li>
          <li>Alinhamento de perfis comportamentais a fun√ß√µes adequadas.</li>
          <li>Redu√ß√£o de ru√≠dos de comunica√ß√£o em equipes.</li>
          <li>Suporte em processos de recrutamento e desenvolvimento profissional.</li>
          <li>Promo√ß√£o do autodesenvolvimento e da colabora√ß√£o.</li>
        </ul>
      </div>
      <p class="text-right mt-4 text-xl signature">Rog√©rio Braga - impulsoflow@gmail.com</p>
    </div>
  </div>

  <script>
    // === AFIRMA√á√ïES ===
    const affirmations = [
      "Decido r√°pido e com confian√ßa mesmo em momentos de press√£o",
      "Inspiro e engajo as pessoas ao meu redor com facilidade",
      "Mantenho a serenidade em momentos de alta tens√£o",
      "Reviso tudo com cuidado antes de dar algo como conclu√≠do",
      "Encaro problemas de cabe√ßa erguida, sem recuar",
      "Conecto-me com facilidade em eventos e construo contatos ",
      "Priorizo conex√µes s√≥lidas e duradouras",
      "Cumpro regras e procedimentos com rigor e consist√™ncia",
      "Competi√ß√£o me motiva a dar o meu melhor",
      "Conven√ßo com clareza e argumentos s√≥lidos",
      "Colaboro com os colegas, mesmo em pontos de discord√¢ncia",
      "Baseio minhas escolhas em an√°lises de dados claras",
      "Tomo riscos inteligentes para atingir objetivos",
      "Me destaco naturalmente em din√¢micas de grupo",
      "Promovo harmonia e evito conflitos desnecess√°rios",
      "Confio em dados concretos para guiar minhas a√ß√µes",
      "Me adapto facilmente a estruturas hier√°rquicas",
      "Passo confian√ßa com minha energia positiva",
      "Tenho paci√™ncia para lidar com processos longos",
      "Ajusto erros assim que os identifico",
      "Apresento minhas ideias com firmeza e clareza",
      "Trago humor e crio um clima positivo ao meu redor",
      "Honro meus compromissos com total dedica√ß√£o",
      "Planejo meu trabalho com base em prioridades e prazos definidos",
      "Assumo a lideran√ßa de projetos at√© a entrega final",
      "Engajo plateias com apresenta√ß√µes claras e cativantes",
      "Valorizo o trabalho em equipe acima da competi√ß√£o",
      "Confirmo fontes para garantir que a informa√ß√£o √© s√≥lida",
      "Prefiro agir r√°pido a planejar por muito tempo",
      "Ajudo a criar um ambiente onde todos se sentem acolhidos",
      "Me mantenho organizado, mesmo em cen√°rios inst√°veis",
      "Monitoro meu trabalho com sistemas e planilhas",
      "Enfrentar desafios me faz crescer e melhorar",
      "Vejo o lado positivo, mesmo em cen√°rios complicados",
      "Priorizo ouvir ativamente em debates e discuss√µes",
      "Checo informa√ß√µes que parecem duvidosas ou incoerentes",
      "Objetivos ambiciosos me empolgam e impulsionam",
      "Crio conex√µes estrat√©gicas com facilidade",
      "Prefiro rotinas organizadas e sem surpresas",
      "Registro tudo para garantir clareza e evitar erros",
      "Assumo a frente quando ningu√©m d√° o primeiro passo",
      "Sou emp√°tico e compreendo bem os sentimentos alheios",
      "Funciono bem com acompanhamento constante",
      "Encontro tend√™ncias e padr√µes em an√°lises de dados",
      "Foco em entregar resultados acima de tudo",
      "Me divirto em eventos sociais e momentos de celebra√ß√£o",
      "Sempre cumpro o que me comprometo a fazer",
      "Evito agir por impulso, priorizando a an√°lise"
    ];

    const discMapping = {
      1: 'D', 2: 'I', 3: 'S', 4: 'C',
      5: 'D', 6: 'I', 7: 'S', 8: 'C',
      9: 'D', 10: 'I', 11: 'S', 12: 'C',
      13: 'D', 14: 'I', 15: 'S', 16: 'C',
      17: 'D', 18: 'I', 19: 'S', 20: 'C',
      21: 'D', 22: 'I', 23: 'S', 24: 'C',
      25: 'D', 26: 'I', 27: 'S', 28: 'C',
      29: 'D', 30: 'I', 31: 'S', 32: 'C',
      33: 'D', 34: 'I', 35: 'S', 36: 'C',
      37: 'D', 38: 'I', 39: 'S', 40: 'C',
      41: 'D', 42: 'I', 43: 'S', 44: 'C',
      45: 'D', 46: 'I', 47: 'S', 48: 'C'
    };

    let current = 0;
    const responses = new Array(48).fill(null);

    function sanitize(str) {
      return str.replace(/[<>&"']/g, char => ({ '<': '&lt;', '>': '&gt;', '&': '&amp;', '"': '&quot;', "'": '&#39;' }[char]));
    }

    function validateEmail(email) {
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    function startTest() {
      const name = document.getElementById('name').value.trim();
      const age = document.getElementById('age').value.trim();
      const email = document.getElementById('email').value.trim();
      if (!name || !age || !email || !validateEmail(email)) {
        alert('Preencha todos os campos corretamente.');
        return;
      }
      document.getElementById('intro').classList.add('hidden');
      document.getElementById('test-section').classList.remove('hidden');
      loadQuestion(0);
    }

    function loadQuestion(index) {
      current = index;
      const qNum = index + 1;
      const progress = Math.round(((qNum - 1) / 48) * 100);
      const html = `
        <div class="bg-gradient-to-r from-blue-50 to-teal-50 p-5 rounded-lg shadow-md">
          <p class="text-lg font-semibold text-gray-800 mb-4">Pergunta ${String(qNum).padStart(2, '0')} de 48</p>
          <p class="text-2xl font-bold text-center mb-6">"${affirmations[index]}"</p>
          <div class="grid grid-cols-5 gap-2 mb-6">
            ${[1,2,3,4,5].map(val => `
              <div class="scale-option" data-value="${val}" onclick="selectAnswer(${qNum}, ${val})">
                ${val}<br><small>${val === 1 ? 'Discordo totalmente' : val === 2 ? 'Discordo' : val === 3 ? 'Neutro' : val === 4 ? 'Concordo' : 'Concordo totalmente'}</small>
              </div>
            `).join('')}
          </div>
          <div class="flex flex-col items-center">
            ${index < 47 ? 
              `<button onclick="nextQuestion(${index})" class="btn-primary text-white px-6 py-3 rounded-lg text-base ${responses[index] === null ? 'opacity-50 cursor-not-allowed' : ''}">Pr√≥xima</button>` :
              `<button onclick="showResult()" class="btn-result text-white px-6 py-3 rounded-lg text-base ${responses[index] === null ? 'opacity-50 cursor-not-allowed' : ''}">Ver Resultado</button>`
            }
            ${index > 0 ? `<button onclick="loadQuestion(${index - 1})" class="btn-secondary text-white px-4 py-2 rounded-lg text-sm mt-2">Anterior</button>` : ``}
          </div>
          <div class="progress-bar">
            <div class="progress-bar-fill" style="width: ${progress}%"></div>
          </div>
        </div>
        <input type="hidden" id="q${qNum}" value="${responses[index] || ''}">
      `;
      document.getElementById('current-question').innerHTML = html;
      if (responses[index] !== null) {
        document.querySelector(`.scale-option[data-value="${responses[index]}"]`).classList.add('selected');
      }
    }

    function selectAnswer(qNum, value) {
      responses[qNum - 1] = value;
      document.querySelectorAll('.scale-option').forEach(el => el.classList.remove('selected'));
      document.querySelector(`.scale-option[data-value="${value}"]`).classList.add('selected');
      document.getElementById(`q${qNum}`).value = value;
    }

    function nextQuestion(index) {
      if (responses[index] === null) {
        alert('Selecione uma op√ß√£o antes de continuar.');
        return;
      }
      loadQuestion(index + 1);
    }

    function showResult() {
      if (responses[47] === null) {
        alert('Responda a √∫ltima pergunta.');
        return;
      }

      let scores = { D: 0, I: 0, S: 0, C: 0 };
      for (let i = 1; i <= 48; i++) {
        const val = responses[i - 1];
        const style = discMapping[i];
        scores[style] += val;
      }

      const total = scores.D + scores.I + scores.S + scores.C;
      const pct = {
        D: Math.round((scores.D / total) * 100),
        I: Math.round((scores.I / total) * 100),
        S: Math.round((scores.S / total) * 100),
        C: Math.round((scores.C / total) * 100)
      };

      let sum = pct.D + pct.I + pct.S + pct.C;
      if (sum !== 100) pct.D += (100 - sum);

      document.getElementById('test-section').classList.add('hidden');
      document.getElementById('result').classList.remove('hidden');

      const maxWidth = 400;

      setTimeout(() => {
        const setBar = (id, pctVal, color) => {
          const bar = document.getElementById(id);
          bar.style.width = `${(pctVal / 100) * maxWidth}px`;
          bar.style.background = color;
          document.getElementById(`val-${id.split('-')[1]}`).textContent = `${pctVal}%`;
        };

        setBar('bar-dominancia', pct.D, 'linear-gradient(135deg, #ef4444, #b91c1c)');
        setBar('bar-influencia', pct.I, 'linear-gradient(135deg, #f59e0b, #b45309)');
        setBar('bar-estabilidade', pct.S, 'linear-gradient(135deg, #3b82f6, #1e40af)');
        setBar('bar-conformidade', pct.C, 'linear-gradient(135deg, #10b981, #047857)');
      }, 300);

      const sorted = Object.entries(pct).sort((a, b) => b[1] - a[1]);
      const primary = sorted[0][0];
      const secondary = sorted[1][0];

      const info = {
        D: { 
          name: 'Domin√¢ncia (Col√©rico)', 
          desc: 'L√≠der nato, focado em resultados, direto e determinado. Excelente em tomar decis√µes r√°pidas e enfrentar desafios.',
          details: `Pessoas com Domin√¢ncia s√£o movidas por desafios e resultados. S√£o assertivas, confiantes e preferem ambientes onde podem assumir o controle. No trabalho, destacam-se em pap√©is de lideran√ßa, como gerentes ou empreendedores, tomando decis√µes r√°pidas e enfrentando obst√°culos com determina√ß√£o. Seus pontos fortes incluem coragem, iniciativa e foco em metas.\n\n**Fraquezas**: Podem ser impacientes, autorit√°rias ou insens√≠veis √†s necessidades dos outros, especialmente sob press√£o. Podem ignorar detalhes importantes em prol de resultados r√°pidos, o que pode levar a erros. Tamb√©m tendem a evitar delegar tarefas, preferindo controlar tudo, e podem parecer agressivas em discuss√µes. Sua dificuldade em ouvir opini√µes contr√°rias pode gerar conflitos desnecess√°rios. Para melhorar, devem praticar escuta ativa, desenvolver paci√™ncia e valorizar a colabora√ß√£o.`
        },
        I: { 
          name: 'Influ√™ncia (Sangu√≠neo)', 
          desc: 'Comunicativo, entusiasta e persuasivo. Motiva equipes e cria conex√µes com facilidade.',
          details: `Indiv√≠duos com Influ√™ncia s√£o extrovertidos, carism√°ticos e adoram interagir. S√£o excelentes em vendas, marketing ou pap√©is que exigem networking, pois inspiram e motivam com facilidade. Seus pontos fortes incluem habilidades de comunica√ß√£o, otimismo e capacidade de criar ambientes positivos.\n\n**Fraquezas**: Podem ser desorganizados, impulsivos ou negligenciar detalhes t√©cnicos, o que pode comprometer projetos. Tendem a evitar tarefas rotineiras, preferindo atividades sociais, e podem prometer mais do que conseguem entregar. Sua tend√™ncia a buscar aprova√ß√£o pode lev√°-los a evitar confrontos ou decis√µes dif√≠ceis. Para crescer, devem desenvolver disciplina, foco em detalhes e consist√™ncia em compromissos de longo prazo.`
        },
        S: { 
          name: 'Estabilidade (Fleum√°tico)', 
          desc: 'Calmo, leal e colaborativo. Valoriza harmonia e oferece suporte em ambientes est√°veis.',
          details: `Pessoas com Estabilidade s√£o pac√≠ficas, confi√°veis e preferem rotinas previs√≠veis. S√£o ideais para fun√ß√µes de suporte, como recursos humanos ou atendimento ao cliente, onde sua paci√™ncia e empatia brilham. Seus pontos fortes incluem lealdade, trabalho em equipe e habilidade de ouvir.\n\n**Fraquezas**: Podem ser resistentes a mudan√ßas, evitar conflitos a ponto de suprimir opini√µes e ter dificuldade em tomar decis√µes r√°pidas. Sua tend√™ncia a manter a harmonia pode levar √† passividade ou √† aceita√ß√£o de situa√ß√µes desfavor√°veis. Podem parecer lentos em ambientes din√¢micos e evitar assumir riscos. Para melhorar, devem praticar assertividade, adaptar-se a mudan√ßas e expressar suas ideias com confian√ßa.`
        },
        C: { 
          name: 'Conformidade (Melanc√≥lico)', 
          desc: 'Anal√≠tico, detalhista e organizado. Prioriza precis√£o e qualidade no trabalho.',
          details: `Indiv√≠duos com Conformidade s√£o meticulosos, l√≥gicos e focados em qualidade. Excelentes em √°reas como contabilidade, engenharia ou pesquisa, eles valorizam dados e processos estruturados. Seus pontos fortes incluem precis√£o, organiza√ß√£o e aten√ß√£o aos detalhes.\n\n**Fraquezas**: Podem ser excessivamente perfeccionistas, o que atrasa projetos, ou hesitar em decidir sem todas as informa√ß√µes. Tendem a ser cr√≠ticos demais, tanto consigo quanto com os outros, e podem resistir a abordagens menos estruturadas. Sua relut√¢ncia em delegar pode sobrecarreg√°-los, e a tend√™ncia a focar em erros pode minar a confian√ßa da equipe. Para crescer, devem desenvolver flexibilidade, aceitar riscos calculados e confiar mais na intui√ß√£o.`
        }
      };

      const p = info[primary];
      const s = info[secondary];

      document.getElementById('personal-data').innerHTML = `Nome: ${sanitize(document.getElementById('name').value.trim())} | Idade: ${sanitize(document.getElementById('age').value.trim())} | Profiss√£o: ${sanitize(document.getElementById('occupation').value.trim())} | Email: ${sanitize(document.getElementById('email').value.trim())}`;

      document.getElementById('dominant-section').innerHTML = `
        <div class="bg-gradient-to-r from-red-50 to-red-100 p-3 rounded-lg border-l-4 border-red-500">
          <h3 class="text-lg font-bold text-gray-800">Perfil Prim√°rio: ${p.name} (${pct[primary]}%)</h3>
          <p class="mt-1 text-xs">${p.desc}</p>
          <p class="mt-1 text-xs">${p.details.replace(/\n\n/g, '<br><br>')}</p>
        </div>
        <div class="bg-gradient-to-r from-orange-50 to-orange-100 p-3 rounded-lg border-l-4 border-orange-500">
          <h3 class="text-lg font-bold text-gray-800">Perfil Secund√°rio: ${s.name} (${pct[secondary]}%)</h3>
          <p class="mt-1 text-xs">${s.desc}</p>
          <p class="mt-1 text-xs">${s.details.replace(/\n\n/g, '<br><br>')}</p>
        </div>
      `;

      window.userData = {
        name: document.getElementById('name').value.trim(),
        age: document.getElementById('age').value.trim(),
        occupation: document.getElementById('occupation').value.trim(),
        email: document.getElementById('email').value.trim(),
        pct,
        primary,
        secondary,
        p,
        s
      };

      setTimeout(generatePDF, 1500);
    }

    async function generatePDF() {
      if (!window.jspdf) {
        alert('Erro ao carregar biblioteca PDF.');
        return;
      }
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ orientation: 'portrait', unit: 'mm', format: 'a4' });
      const pageWidth = 210;
      let y = 10;

      const data = window.userData;

      // === CABE√áALHO ===
      doc.setFillColor(6, 182, 212);
      doc.rect(0, 0, pageWidth, 25, 'F');
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(18);
      doc.setTextColor(255, 255, 255);
      doc.text('Pesquisa Impulso DISC', pageWidth / 2, 12, { align: 'center' });
      doc.setFontSize(10);
      doc.text(`Relat√≥rio para: ${sanitize(data.name)}`, pageWidth / 2, 20, { align: 'center' });
      y += 25;

      // === DADOS PESSOAIS ===
      doc.setFillColor(241, 245, 249);
      doc.rect(15, y, 180, 12, 'F');
      doc.setDrawColor(30, 64, 175);
      doc.setLineWidth(0.5);
      doc.roundedRect(15, y, 180, 12, 3, 3, 'S');
      doc.setTextColor(0, 0, 0);
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(10);
      doc.text('üìã Dados Pessoais', 18, y + 4);
      doc.setFont('helvetica', 'normal');
      doc.setFontSize(8);
      const personalData = `Nome: ${sanitize(data.name)} | Idade: ${sanitize(data.age)} | Profiss√£o: ${sanitize(data.occupation)} | Email: ${sanitize(data.email)}`;
      doc.text(personalData, 18, y + 9, { maxWidth: 170 });
      y += 20;

      // === GR√ÅFICO DE BARRAS HORIZONTAIS ===
      try {
        const scoresEl = document.getElementById('scores');
        const canvas = await html2canvas(scoresEl, { scale: 2, useCORS: true });
        const img = canvas.toDataURL('image/png');
        const imgHeight = 30;
        doc.setFillColor(241, 245, 249);
        doc.rect(15, y, 180, imgHeight + 8, 'F');
        doc.roundedRect(15, y, 180, imgHeight + 8, 3, 3, 'S');
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(10);
        doc.text('üìä Resultado DISC (%)', 18, y + 4);
        doc.addImage(img, 'PNG', 20, y + 8, 170, imgHeight);
        y += imgHeight + 20;
      } catch (e) {
        console.error('Erro ao capturar gr√°fico:', e);
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(8);
        doc.text('Erro ao carregar gr√°fico.', 18, y + 5);
        y += 20;
      }

      // === EXPLICA√á√ÉO DO DISC ===
      const discText = `‚ÑπÔ∏è O que √© o DISC?
O DISC √© uma metodologia de avalia√ß√£o comportamental desenvolvida por William Marston, utilizada por mais de 53 milh√µes de pessoas em 38 anos. Categoriza comportamentos em quatro dimens√µes: Domin√¢ncia (D), Influ√™ncia (I), Estabilidade (S) e Conformidade (C). Cada dimens√£o reflete como as pessoas enfrentam desafios, interagem, lidam com mudan√ßas e seguem processos.

Benef√≠cios:
‚Ä¢ Desenvolvimento de lideran√ßa e resolu√ß√£o de conflitos
‚Ä¢ Alinhamento de perfis a fun√ß√µes adequadas
‚Ä¢ Redu√ß√£o de ru√≠dos de comunica√ß√£o em equipes
‚Ä¢ Suporte em recrutamento e desenvolvimento
‚Ä¢ Promo√ß√£o de autoconhecimento e colabora√ß√£o`;

      doc.setFillColor(219, 234, 254);
      doc.rect(15, y, 180, 50, 'F');
      doc.roundedRect(15, y, 180, 50, 3, 3, 'S');
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(10);
      doc.text('‚ÑπÔ∏è O que √© o DISC?', 18, y + 4);
      doc.setFont('helvetica', 'normal');
      doc.setFontSize(8);
      doc.text(discText, 18, y + 9, { maxWidth: 170, lineHeightFactor: 1.15 });
      y += 60;

      // === PERFIL PRIM√ÅRIO ===
      doc.setFillColor(255, 241, 242);
      doc.rect(15, y, 180, 80, 'F');
      doc.roundedRect(15, y, 180, 80, 3, 3, 'S');
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(10);
      doc.setTextColor(185, 28, 28);
      doc.text(`üîù Perfil Prim√°rio: ${data.p.name} (${data.pct[data.primary]}%)`, 18, y + 4);
      doc.setTextColor(0, 0, 0);
      doc.setFont('helvetica', 'normal');
      doc.setFontSize(8);
      const primaryDesc = `${data.p.desc}\n\n${data.p.details}`;
      doc.text(primaryDesc, 18, y + 9, { maxWidth: 170, lineHeightFactor: 1.15 });
      y += 60;

      // === PERFIL SECUND√ÅRIO ===
      doc.setFillColor(255, 247, 237);
      doc.rect(15, y, 180, 80, 'F');
      doc.roundedRect(15, y, 180, 80, 3, 3, 'S');
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(10);
      doc.setTextColor(194, 65, 12);
      doc.text(`üîó Perfil Secund√°rio: ${data.s.name} (${data.pct[data.secondary]}%)`, 18, y + 4);
      doc.setTextColor(0, 0, 0);
      doc.setFont('helvetica', 'normal');
      doc.setFontSize(8);
      const secondaryDesc = `${data.s.desc}\n\n${data.s.details}`;
      doc.text(secondaryDesc, 18, y + 9, { maxWidth: 170, lineHeightFactor: 1.15 });
      y += 60;

      // === RODAP√â ===
      doc.setFontSize(8);
      doc.setFont('helvetica', 'italic');
      doc.setTextColor(30, 64, 175);
      doc.text('Relat√≥rio gerado por Impulso Coaching ‚Ä¢ impulsoflow@gmail.com', pageWidth / 2, 285, { align: 'center' });

      const pdfName = `resultado_disc_${data.name.replace(/\s+/g, '_')}.pdf`;
      doc.save(pdfName);

      const subject = encodeURIComponent(`Resultado da Pesquisa Impulso DISC - ${data.name}`);
      const body = encodeURIComponent(
        `Nome: ${data.name}\nIdade: ${data.age}\nProfiss√£o: ${data.occupation}\nEmail: ${data.email}\n\n` +
        `Resultados DISC:\n` +
        `- Domin√¢ncia: ${data.pct.D}%\n` +
        `- Influ√™ncia: ${data.pct.I}%\n` +
        `- Estabilidade: ${data.pct.S}%\n` +
        `- Conformidade: ${data.pct.C}%\n\n` +
        `Perfil Prim√°rio: ${data.p.name} (${data.pct[data.primary]}%)\n` +
        `${data.p.desc}\n${data.p.details}\n\n` +
        `Perfil Secund√°rio: ${data.s.name} (${data.pct[data.secondary]}%)\n` +
        `${data.s.desc}\n${data.s.details}\n\n` +
        `Por favor, anexe o arquivo "${pdfName}" ao e-mail.\n\n` +
        `Atenciosamente,\nImpulso Coaching`
      );
      window.location.href = `mailto:impulsoflow@gmail.com?subject=${subject}&body=${body}`;

      setTimeout(() => {
        alert(`‚úÖ PDF "${pdfName}" salvo com sucesso!\nüìß E-mail aberto ‚Äî anexe o PDF.`);
      }, 600);
    }
  </script>
</body>
</html>
